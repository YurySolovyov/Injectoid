(function(h,e){"function"===typeof define&&define.amd?define(["exports"],e):"object"===typeof exports?e(exports):e(h)})(this,function(h){var e=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,l=function(a){return a.toString().match(e)[1].split(/\s*,\s*/gi).filter(function(b){return b&&0<b.length})},m=function(a,b){return a.map(function(a){return b[a]})},n=function(a,b){return a.every(function(a){return b.hasOwnProperty(a)})},p=function(a,b,f,c){c=c||[];b.forEach(function(b){var g=f[b];if(g){g=g.args||l(g);c=
c.concat(g);if(-1<c.indexOf(a))throw Error("Circular dependency detected: "+a+" <=> "+b);p(a,g,f,c)}})},q=function(a,b){0!==a.length&&a.forEach(function(a){var c=a.args;n(c,b)&&(c=m(c,b),a.callback.apply(null,c))})};h.Injectoid=function(){var a=this,b={},f={},c=[],e=function(a,d,c){var e=n(d,b);e&&(d=m(d,b),c=c.apply(null,d),delete f[a],b[a]=c,g());return e},g=function(){var a=Object.keys(f);0!==a.length&&a.forEach(function(a){var b=f[a];b&&e(a,b.args,b.callback)})};a.provide=function(k,d){if("undefined"===
typeof d)throw new TypeError("Provider must be a function, object or value");if("function"===typeof d){var h=l(d);p(k,h,f);e(k,h,d)||(f[k]={args:h,callback:d})}else delete f[k],b[k]=d,g();q(c,b);return a};a.run=function(e){var d=l(e);n(d,b)?(d=m(d,b),e.apply(null,d)):c.push({args:d,callback:e});return a}}});
