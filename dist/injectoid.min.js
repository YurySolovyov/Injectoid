(function(h,g){"function"===typeof define&&define.amd?define(["exports"],g):"object"===typeof exports?g(exports):g(h)})(this,function(h){var g=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,k=function(a){return a.toString().match(g)[1].split(/\s*,\s*/gi).filter(function(b){return b&&0<b.length})},l=function(a,b){return a.map(function(a){return b[a]})},m=function(a,b){return a.every(function(a){return b.hasOwnProperty(a)})},n=function(a,b,e,c){c=c||[];b.forEach(function(b){var f=e[b];if(f){f=k(f);c=c.concat(f);
if(-1<c.indexOf(a))throw Error("Circular dependency detected: "+a+" <=> "+b);n(a,f,e,c)}})};h.Injectoid=function(){var a=this,b={},e={},c=[],g=function(){0!==c.length&&c.forEach(function(a){var d=a.args;m(d,b)&&(d=l(d,b),a.callback.apply(null,d))})},f=function(){var a=Object.keys(e);0!==a.length&&a.forEach(function(a){var b=e[a];b&&h(a,b)})},h=function(a,d){if("function"===typeof d){var c=k(d);n(a,c,e);m(c,b)?(c=l(c,b),c=d.apply(null,c),delete e[a],b[a]=c,f()):e[a]=d}else delete e[a],b[a]=d,f();g()};
a.provide=function(b,c){h(b,c);return a};a.run=function(e){var d=k(e);m(d,b)?(d=l(d,b),e.apply(null,d)):c.push({args:d,callback:e});return a}}});
